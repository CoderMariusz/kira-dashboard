
> kira-dashboard@0.1.0 test
> vitest run src/__tests__/US-8.2/


[1m[46m RUN [49m[22m [36mv4.0.18 [39m[90m/Users/mariuszkrawczyk/CoderMariusz/kira-dashboard[39m

 [31mâ¯[39m src/__tests__/US-8.2/hooks.test.ts [2m([22m[2m0 test[22m[2m)[22m
[90mstderr[2m | src/__tests__/US-8.2/validation.test.ts[2m > [22m[2mAC4: Story Validation[2m > [22m[2mAC4.5: should reject story creation without parent_id with 400 error
[22m[39m[API] Error creating story: [1mnull[22m

[90mstderr[2m | src/__tests__/US-8.2/api-get.test.ts[2m > [22m[2mGET /api/epics[2m > [22m[2mAC1.3: should return list of all epics for user's household
[22m[39m[API] Error in GET /api/epics: TypeError: supabase.from(...).select(...).eq(...).eq is not a function
    at Module.GET [90m(/Users/mariuszkrawczyk/CoderMariusz/kira-dashboard/[39msrc/app/api/epics/route.ts:55:8[90m)[39m
[90m    at processTicksAndRejections (node:internal/process/task_queues:104:5)[39m
    at [90m/Users/mariuszkrawczyk/CoderMariusz/kira-dashboard/[39msrc/__tests__/US-8.2/api-get.test.ts:153:22
    at [90mfile:///Users/mariuszkrawczyk/CoderMariusz/kira-dashboard/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:20

[90mstderr[2m | src/__tests__/US-8.2/validation.test.ts[2m > [22m[2mAC5: Error Handling[2m > [22m[2mAC5.2: should return 403 with "Access Denied" for wrong household
[22m[39m[API] Error in GET /api/epics/[id]: TypeError: supabase.from(...).select(...).eq(...).eq is not a function
    at GET [90m(/Users/mariuszkrawczyk/CoderMariusz/kira-dashboard/[39msrc/app/api/epics/[id]/route.ts:41:8[90m)[39m
[90m    at processTicksAndRejections (node:internal/process/task_queues:104:5)[39m
    at [90m/Users/mariuszkrawczyk/CoderMariusz/kira-dashboard/[39msrc/__tests__/US-8.2/validation.test.ts:450:22
    at [90mfile:///Users/mariuszkrawczyk/CoderMariusz/kira-dashboard/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:20

[90mstderr[2m | src/__tests__/US-8.2/validation.test.ts[2m > [22m[2mAC5: Error Handling[2m > [22m[2mAC5.3: should return 404 with "Not Found" for non-existent resource
[22m[39m[API] Error in GET /api/epics/[id]: TypeError: supabase.from(...).select(...).eq(...).eq is not a function
    at GET [90m(/Users/mariuszkrawczyk/CoderMariusz/kira-dashboard/[39msrc/app/api/epics/[id]/route.ts:41:8[90m)[39m
[90m    at processTicksAndRejections (node:internal/process/task_queues:104:5)[39m
    at [90m/Users/mariuszkrawczyk/CoderMariusz/kira-dashboard/[39msrc/__tests__/US-8.2/validation.test.ts:470:22
    at [90mfile:///Users/mariuszkrawczyk/CoderMariusz/kira-dashboard/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:20

[90mstderr[2m | src/__tests__/US-8.2/validation.test.ts[2m > [22m[2mAC5: Error Handling[2m > [22m[2mAC5.5: should return 500 with error details for database errors
[22m[39m[API] Error in GET /api/epics: TypeError: supabase.from(...).select(...).eq(...).eq is not a function
    at GET [90m(/Users/mariuszkrawczyk/CoderMariusz/kira-dashboard/[39msrc/app/api/epics/route.ts:55:8[90m)[39m
[90m    at processTicksAndRejections (node:internal/process/task_queues:104:5)[39m
    at [90m/Users/mariuszkrawczyk/CoderMariusz/kira-dashboard/[39msrc/__tests__/US-8.2/validation.test.ts:501:22
    at [90mfile:///Users/mariuszkrawczyk/CoderMariusz/kira-dashboard/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:20

[90mstderr[2m | src/__tests__/US-8.2/api-get.test.ts[2m > [22m[2mGET /api/epics[2m > [22m[2mAC1.4: should include story count for each epic
[22m[39m[API] Error in GET /api/epics: TypeError: supabase.from(...).select(...).eq(...).eq is not a function
    at Module.GET [90m(/Users/mariuszkrawczyk/CoderMariusz/kira-dashboard/[39msrc/app/api/epics/route.ts:55:8[90m)[39m
[90m    at processTicksAndRejections (node:internal/process/task_queues:104:5)[39m
    at [90m/Users/mariuszkrawczyk/CoderMariusz/kira-dashboard/[39msrc/__tests__/US-8.2/api-get.test.ts:170:22
    at [90mfile:///Users/mariuszkrawczyk/CoderMariusz/kira-dashboard/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:20

 [31mâ¯[39m src/__tests__/US-8.2/validation.test.ts [2m([22m[2m17 tests[22m[2m | [22m[31m4 failed[39m[2m)[22m[32m 19[2mms[22m[39m
     [32mâœ“[39m AC4.1: should reject epic creation without title with 400 error[32m 7[2mms[22m[39m
     [32mâœ“[39m AC4.2: should reject epic with empty title string with 400 error[32m 1[2mms[22m[39m
     [32mâœ“[39m AC4.3: should reject epic with title longer than 255 chars with 400 error[32m 0[2mms[22m[39m
     [32mâœ“[39m AC4.4: should accept epic with valid title (1-255 chars)[32m 1[2mms[22m[39m
[31m     [31mÃ—[31m AC4.5: should reject story creation without parent_id with 400 error[39m[32m 4[2mms[22m[39m
     [32mâœ“[39m AC4.6: should reject story creation without title with 400 error[32m 0[2mms[22m[39m
     [32mâœ“[39m AC4.7: should reject story with empty title string with 400 error[32m 0[2mms[22m[39m
     [32mâœ“[39m AC4.8: should accept story with valid title (1-255 chars)[32m 0[2mms[22m[39m
     [32mâœ“[39m AC4.9: should reject attempt to create story with story as parent with 400 error[32m 0[2mms[22m[39m
     [32mâœ“[39m AC4.10: should reject move story to story with 400 error[32m 1[2mms[22m[39m
[31m     [31mÃ—[31m AC4.11: should reject move story to non-existent parent with 404 error[39m[32m 0[2mms[22m[39m
     [32mâœ“[39m AC5.1: should return 400 with descriptive error message for validation failures[32m 0[2mms[22m[39m
[31m     [31mÃ—[31m AC5.2: should return 403 with "Access Denied" for wrong household[39m[32m 2[2mms[22m[39m
[31m     [31mÃ—[31m AC5.3: should return 404 with "Not Found" for non-existent resource[39m[32m 0[2mms[22m[39m
     [32mâœ“[39m AC5.4: should return 401 for unauthenticated requests[32m 0[2mms[22m[39m
     [32mâœ“[39m AC5.5: should return 500 with error details for database errors[32m 0[2mms[22m[39m
     [32mâœ“[39m AC5.6: should include error field in all error responses[32m 0[2mms[22m[39m
[90mstderr[2m | src/__tests__/US-8.2/api-get.test.ts[2m > [22m[2mGET /api/epics[2m > [22m[2mAC1.5: should return empty array if no epics exist
[22m[39m[API] Error in GET /api/epics: TypeError: supabase.from(...).select(...).eq(...).eq is not a function
    at Module.GET [90m(/Users/mariuszkrawczyk/CoderMariusz/kira-dashboard/[39msrc/app/api/epics/route.ts:55:8[90m)[39m
[90m    at processTicksAndRejections (node:internal/process/task_queues:104:5)[39m
    at [90m/Users/mariuszkrawczyk/CoderMariusz/kira-dashboard/[39msrc/__tests__/US-8.2/api-get.test.ts:190:22
    at [90mfile:///Users/mariuszkrawczyk/CoderMariusz/kira-dashboard/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:20

[90mstderr[2m | src/__tests__/US-8.2/api-get.test.ts[2m > [22m[2mGET /api/epics/[id][2m > [22m[2mAC1.7: should return 404 if epic does not exist
[22m[39m[API] Error in GET /api/epics/[id]: TypeError: supabase.from(...).select(...).eq(...).eq is not a function
    at Module.GET [90m(/Users/mariuszkrawczyk/CoderMariusz/kira-dashboard/[39msrc/app/api/epics/[id]/route.ts:41:8[90m)[39m
[90m    at processTicksAndRejections (node:internal/process/task_queues:104:5)[39m
    at [90m/Users/mariuszkrawczyk/CoderMariusz/kira-dashboard/[39msrc/__tests__/US-8.2/api-get.test.ts:233:22
    at [90mfile:///Users/mariuszkrawczyk/CoderMariusz/kira-dashboard/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:20

[90mstderr[2m | src/__tests__/US-8.2/api-get.test.ts[2m > [22m[2mGET /api/epics/[id][2m > [22m[2mAC1.8: should return 404 if epic belongs to different household
[22m[39m[API] Error in GET /api/epics/[id]: TypeError: supabase.from(...).select(...).eq(...).eq is not a function
    at Module.GET [90m(/Users/mariuszkrawczyk/CoderMariusz/kira-dashboard/[39msrc/app/api/epics/[id]/route.ts:41:8[90m)[39m
[90m    at processTicksAndRejections (node:internal/process/task_queues:104:5)[39m
    at [90m/Users/mariuszkrawczyk/CoderMariusz/kira-dashboard/[39msrc/__tests__/US-8.2/api-get.test.ts:256:22
    at [90mfile:///Users/mariuszkrawczyk/CoderMariusz/kira-dashboard/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:20

[90mstderr[2m | src/__tests__/US-8.2/api-get.test.ts[2m > [22m[2mGET /api/epics/[id][2m > [22m[2mAC1.9: should return epic with nested stories array
[22m[39m[API] Error in GET /api/epics/[id]: TypeError: supabase.from(...).select(...).eq(...).eq is not a function
    at Module.GET [90m(/Users/mariuszkrawczyk/CoderMariusz/kira-dashboard/[39msrc/app/api/epics/[id]/route.ts:41:8[90m)[39m
[90m    at processTicksAndRejections (node:internal/process/task_queues:104:5)[39m
    at [90m/Users/mariuszkrawczyk/CoderMariusz/kira-dashboard/[39msrc/__tests__/US-8.2/api-get.test.ts:274:22
    at [90mfile:///Users/mariuszkrawczyk/CoderMariusz/kira-dashboard/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:20

[90mstderr[2m | src/__tests__/US-8.2/api-get.test.ts[2m > [22m[2mGET /api/epics/[id][2m > [22m[2mAC1.10: should include all story fields (id, title, completed, etc.)
[22m[39m[API] Error in GET /api/epics/[id]: TypeError: supabase.from(...).select(...).eq(...).eq is not a function
    at Module.GET [90m(/Users/mariuszkrawczyk/CoderMariusz/kira-dashboard/[39msrc/app/api/epics/[id]/route.ts:41:8[90m)[39m
[90m    at processTicksAndRejections (node:internal/process/task_queues:104:5)[39m
    at [90m/Users/mariuszkrawczyk/CoderMariusz/kira-dashboard/[39msrc/__tests__/US-8.2/api-get.test.ts:296:22
    at [90mfile:///Users/mariuszkrawczyk/CoderMariusz/kira-dashboard/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:20

[90mstderr[2m | src/__tests__/US-8.2/api-get.test.ts[2m > [22m[2mGET /api/epics/[id]/stories[2m > [22m[2mAC1.12: should return 404 if epic does not exist
[22m[39m[API] Error in GET /api/epics/[id]/stories: TypeError: supabase.from(...).select(...).eq(...).eq is not a function
    at Module.GET [90m(/Users/mariuszkrawczyk/CoderMariusz/kira-dashboard/[39msrc/app/api/epics/[id]/stories/route.ts:51:8[90m)[39m
[90m    at processTicksAndRejections (node:internal/process/task_queues:104:5)[39m
    at [90m/Users/mariuszkrawczyk/CoderMariusz/kira-dashboard/[39msrc/__tests__/US-8.2/api-get.test.ts:344:22
    at [90mfile:///Users/mariuszkrawczyk/CoderMariusz/kira-dashboard/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:20

[90mstderr[2m | src/__tests__/US-8.2/api-get.test.ts[2m > [22m[2mGET /api/epics/[id]/stories[2m > [22m[2mAC1.13: should return 403 if epic belongs to different household
[22m[39m[API] Error in GET /api/epics/[id]/stories: TypeError: supabase.from(...).select(...).eq(...).eq is not a function
    at Module.GET [90m(/Users/mariuszkrawczyk/CoderMariusz/kira-dashboard/[39msrc/app/api/epics/[id]/stories/route.ts:51:8[90m)[39m
[90m    at processTicksAndRejections (node:internal/process/task_queues:104:5)[39m
    at [90m/Users/mariuszkrawczyk/CoderMariusz/kira-dashboard/[39msrc/__tests__/US-8.2/api-get.test.ts:367:22
    at [90mfile:///Users/mariuszkrawczyk/CoderMariusz/kira-dashboard/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:20

[90mstderr[2m | src/__tests__/US-8.2/api-get.test.ts[2m > [22m[2mGET /api/epics/[id]/stories[2m > [22m[2mAC1.14: should return only stories for the specified epic
[22m[39m[API] Error in GET /api/epics/[id]/stories: TypeError: supabase.from(...).select(...).eq(...).eq is not a function
    at Module.GET [90m(/Users/mariuszkrawczyk/CoderMariusz/kira-dashboard/[39msrc/app/api/epics/[id]/stories/route.ts:51:8[90m)[39m
[90m    at processTicksAndRejections (node:internal/process/task_queues:104:5)[39m
    at [90m/Users/mariuszkrawczyk/CoderMariusz/kira-dashboard/[39msrc/__tests__/US-8.2/api-get.test.ts:385:22
    at [90mfile:///Users/mariuszkrawczyk/CoderMariusz/kira-dashboard/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:20

[90mstderr[2m | src/__tests__/US-8.2/api-get.test.ts[2m > [22m[2mGET /api/epics/[id]/stories[2m > [22m[2mAC1.15: should return empty array if epic has no stories
[22m[39m[API] Error in GET /api/epics/[id]/stories: TypeError: supabase.from(...).select(...).eq(...).eq is not a function
    at Module.GET [90m(/Users/mariuszkrawczyk/CoderMariusz/kira-dashboard/[39msrc/app/api/epics/[id]/stories/route.ts:51:8[90m)[39m
[90m    at processTicksAndRejections (node:internal/process/task_queues:104:5)[39m
    at [90m/Users/mariuszkrawczyk/CoderMariusz/kira-dashboard/[39msrc/__tests__/US-8.2/api-get.test.ts:405:22
    at [90mfile:///Users/mariuszkrawczyk/CoderMariusz/kira-dashboard/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:20

 [31mâ¯[39m src/__tests__/US-8.2/api-get.test.ts [2m([22m[2m15 tests[22m[2m | [22m[31m11 failed[39m[2m)[22m[32m 14[2mms[22m[39m
     [32mâœ“[39m AC1.1: should return 401 if user not authenticated[32m 2[2mms[22m[39m
     [32mâœ“[39m AC1.2: should return 400 if user has no household[32m 0[2mms[22m[39m
[31m     [31mÃ—[31m AC1.3: should return list of all epics for user's household[39m[32m 4[2mms[22m[39m
[31m     [31mÃ—[31m AC1.4: should include story count for each epic[39m[32m 1[2mms[22m[39m
[31m     [31mÃ—[31m AC1.5: should return empty array if no epics exist[39m[32m 1[2mms[22m[39m
     [32mâœ“[39m AC1.6: should return 401 if user not authenticated[32m 0[2mms[22m[39m
[31m     [31mÃ—[31m AC1.7: should return 404 if epic does not exist[39m[32m 1[2mms[22m[39m
[31m     [31mÃ—[31m AC1.8: should return 404 if epic belongs to different household[39m[32m 0[2mms[22m[39m
[31m     [31mÃ—[31m AC1.9: should return epic with nested stories array[39m[32m 0[2mms[22m[39m
[31m     [31mÃ—[31m AC1.10: should include all story fields (id, title, completed, etc.)[39m[32m 1[2mms[22m[39m
     [32mâœ“[39m AC1.11: should return 401 if user not authenticated[32m 0[2mms[22m[39m
[31m     [31mÃ—[31m AC1.12: should return 404 if epic does not exist[39m[32m 1[2mms[22m[39m
[31m     [31mÃ—[31m AC1.13: should return 403 if epic belongs to different household[39m[32m 0[2mms[22m[39m
[31m     [31mÃ—[31m AC1.14: should return only stories for the specified epic[39m[32m 0[2mms[22m[39m
[31m     [31mÃ—[31m AC1.15: should return empty array if epic has no stories[39m[32m 0[2mms[22m[39m
[90mstderr[2m | src/__tests__/US-8.2/api-mutations.test.ts[2m > [22m[2mDELETE /api/epics/[id][2m > [22m[2mAC2.19: should return 404 if epic does not exist
[22m[39m[API] Error in DELETE /api/epics/[id]: TypeError: supabase.from(...).select(...).eq(...).eq is not a function
    at Module.DELETE [90m(/Users/mariuszkrawczyk/CoderMariusz/kira-dashboard/[39msrc/app/api/epics/[id]/route.ts:124:8[90m)[39m
[90m    at processTicksAndRejections (node:internal/process/task_queues:104:5)[39m
    at [90m/Users/mariuszkrawczyk/CoderMariusz/kira-dashboard/[39msrc/__tests__/US-8.2/api-mutations.test.ts:526:22
    at [90mfile:///Users/mariuszkrawczyk/CoderMariusz/kira-dashboard/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:20

[90mstderr[2m | src/__tests__/US-8.2/api-mutations.test.ts[2m > [22m[2mDELETE /api/epics/[id][2m > [22m[2mAC2.20: should return 403 if epic belongs to different household
[22m[39m[API] Error in DELETE /api/epics/[id]: TypeError: supabase.from(...).select(...).eq(...).eq is not a function
    at Module.DELETE [90m(/Users/mariuszkrawczyk/CoderMariusz/kira-dashboard/[39msrc/app/api/epics/[id]/route.ts:124:8[90m)[39m
[90m    at processTicksAndRejections (node:internal/process/task_queues:104:5)[39m
    at [90m/Users/mariuszkrawczyk/CoderMariusz/kira-dashboard/[39msrc/__tests__/US-8.2/api-mutations.test.ts:549:22
    at [90mfile:///Users/mariuszkrawczyk/CoderMariusz/kira-dashboard/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:20

[90mstderr[2m | src/__tests__/US-8.2/api-mutations.test.ts[2m > [22m[2mDELETE /api/epics/[id][2m > [22m[2mAC2.21: should delete epic and cascade delete all its stories
[22m[39m[API] Error in DELETE /api/epics/[id]: TypeError: supabase.from(...).select(...).eq(...).eq is not a function
    at Module.DELETE [90m(/Users/mariuszkrawczyk/CoderMariusz/kira-dashboard/[39msrc/app/api/epics/[id]/route.ts:124:8[90m)[39m
[90m    at processTicksAndRejections (node:internal/process/task_queues:104:5)[39m
    at [90m/Users/mariuszkrawczyk/CoderMariusz/kira-dashboard/[39msrc/__tests__/US-8.2/api-mutations.test.ts:574:22
    at [90mfile:///Users/mariuszkrawczyk/CoderMariusz/kira-dashboard/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:20

[90mstderr[2m | src/__tests__/US-8.2/api-mutations.test.ts[2m > [22m[2mDELETE /api/epics/[id][2m > [22m[2mAC2.22: should return 200 on successful deletion
[22m[39m[API] Error in DELETE /api/epics/[id]: TypeError: supabase.from(...).select(...).eq(...).eq is not a function
    at Module.DELETE [90m(/Users/mariuszkrawczyk/CoderMariusz/kira-dashboard/[39msrc/app/api/epics/[id]/route.ts:124:8[90m)[39m
[90m    at processTicksAndRejections (node:internal/process/task_queues:104:5)[39m
    at [90m/Users/mariuszkrawczyk/CoderMariusz/kira-dashboard/[39msrc/__tests__/US-8.2/api-mutations.test.ts:596:22
    at [90mfile:///Users/mariuszkrawczyk/CoderMariusz/kira-dashboard/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:20

 [31mâ¯[39m src/__tests__/US-8.2/api-mutations.test.ts [2m([22m[2m22 tests[22m[2m | [22m[31m8 failed[39m[2m)[22m[32m 14[2mms[22m[39m
     [32mâœ“[39m AC2.1: should return 401 if user not authenticated[32m 3[2mms[22m[39m
     [32mâœ“[39m AC2.2: should return 400 if user has no household[32m 1[2mms[22m[39m
[31m     [31mÃ—[31m AC2.3: should validate that title is required[39m[32m 3[2mms[22m[39m
     [32mâœ“[39m AC2.4: should create epic with type="epic" and parent_id=null[32m 0[2mms[22m[39m
     [32mâœ“[39m AC2.5: should set household_id to user's household[32m 0[2mms[22m[39m
     [32mâœ“[39m AC2.6: should return created epic object with 200 status[32m 0[2mms[22m[39m
     [32mâœ“[39m AC2.7: should return 401 if user not authenticated[32m 0[2mms[22m[39m
     [32mâœ“[39m AC2.8: should return 404 if epic does not exist[32m 0[2mms[22m[39m
     [32mâœ“[39m AC2.9: should return 403 if epic belongs to different household[32m 0[2mms[22m[39m
[31m     [31mÃ—[31m AC2.10: should validate that title is required[39m[32m 0[2mms[22m[39m
     [32mâœ“[39m AC2.11: should create story with type="story" and parent_id=epicId[32m 0[2mms[22m[39m
     [32mâœ“[39m AC2.12: should return created story object with 200 status[32m 0[2mms[22m[39m
     [32mâœ“[39m AC2.13: should return 401 if user not authenticated[32m 0[2mms[22m[39m
     [32mâœ“[39m AC2.14: should return 404 if story does not exist[32m 0[2mms[22m[39m
     [32mâœ“[39m AC2.15: should return 403 if story belongs to different household[32m 0[2mms[22m[39m
[31m     [31mÃ—[31m AC2.16: should update parent_id of story[39m[32m 0[2mms[22m[39m
[31m     [31mÃ—[31m AC2.17: should return 200 with updated story[39m[32m 1[2mms[22m[39m
     [32mâœ“[39m AC2.18: should return 401 if user not authenticated[32m 0[2mms[22m[39m
[31m     [31mÃ—[31m AC2.19: should return 404 if epic does not exist[39m[32m 1[2mms[22m[39m
[31m     [31mÃ—[31m AC2.20: should return 403 if epic belongs to different household[39m[32m 0[2mms[22m[39m
[31m     [31mÃ—[31m AC2.21: should delete epic and cascade delete all its stories[39m[32m 0[2mms[22m[39m
[31m     [31mÃ—[31m AC2.22: should return 200 on successful deletion[39m[32m 0[2mms[22m[39m

[31mâ¯â¯â¯â¯â¯â¯[39m[1m[41m Failed Suites 1 [49m[22m[31mâ¯â¯â¯â¯â¯â¯â¯[39m

[41m[1m FAIL [22m[49m src/__tests__/US-8.2/hooks.test.ts[2m [ src/__tests__/US-8.2/hooks.test.ts ][22m
[31m[1mError[22m: Transform failed with 1 error:
/Users/mariuszkrawczyk/CoderMariusz/kira-dashboard/src/__tests__/US-8.2/hooks.test.ts:195:27: ERROR: Expected ">" but found "client"[39m
  Plugin: [35mvite:esbuild[39m
  File: [36m/Users/mariuszkrawczyk/CoderMariusz/kira-dashboard/src/__tests__/US-8.2/hooks.test.ts[39m:195:27
[33m  
  Expected ">" but found "client"
  193 |      const queryClient = createTestQueryClient();
  194 |      const wrapper = ({ children }: { children: React.ReactNode }) => (
  195 |        <QueryClientProvider client={queryClient}>{children}</QueryClientProvider>
      |                             ^
  196 |      );
  197 |  
  [39m
[90m [2mâ¯[22m failureErrorWithLog node_modules/esbuild/lib/main.js:[2m1467:15[22m[39m
[90m [2mâ¯[22m node_modules/esbuild/lib/main.js:[2m736:50[22m[39m
[90m [2mâ¯[22m responseCallbacks.<computed> node_modules/esbuild/lib/main.js:[2m603:9[22m[39m
[90m [2mâ¯[22m handleIncomingPacket node_modules/esbuild/lib/main.js:[2m658:12[22m[39m
[90m [2mâ¯[22m Socket.readFromStdout node_modules/esbuild/lib/main.js:[2m581:7[22m[39m

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[1/24]â¯[22m[39m


[31mâ¯â¯â¯â¯â¯â¯[39m[1m[41m Failed Tests 23 [49m[22m[31mâ¯â¯â¯â¯â¯â¯â¯[39m

[41m[1m FAIL [22m[49m src/__tests__/US-8.2/api-get.test.ts[2m > [22mGET /api/epics[2m > [22mAC1.3: should return list of all epics for user's household
[31m[1mAssertionError[22m: expected 500 to be 200 // Object.is equality[39m

[32m- Expected[39m
[31m+ Received[39m

[32m- 200[39m
[31m+ 500[39m

[36m [2mâ¯[22m src/__tests__/US-8.2/api-get.test.ts:[2m156:29[22m[39m
    [90m154| [39m    [35mconst[39m json [33m=[39m [35mawait[39m response[33m.[39m[34mjson[39m()[33m;[39m
    [90m155| [39m
    [90m156| [39m    [34mexpect[39m(response[33m.[39mstatus)[33m.[39m[34mtoBe[39m([34m200[39m)[33m;[39m
    [90m   | [39m                            [31m^[39m
    [90m157| [39m    [34mexpect[39m([33mArray[39m[33m.[39m[34misArray[39m(json[33m.[39mepics))[33m.[39m[34mtoBe[39m([35mtrue[39m)[33m;[39m
    [90m158| [39m  })[33m;[39m

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[2/24]â¯[22m[39m

[41m[1m FAIL [22m[49m src/__tests__/US-8.2/api-get.test.ts[2m > [22mGET /api/epics[2m > [22mAC1.4: should include story count for each epic
[31m[1mAssertionError[22m: expected 500 to be 200 // Object.is equality[39m

[32m- Expected[39m
[31m+ Received[39m

[32m- 200[39m
[31m+ 500[39m

[36m [2mâ¯[22m src/__tests__/US-8.2/api-get.test.ts:[2m173:29[22m[39m
    [90m171| [39m    [35mconst[39m json [33m=[39m [35mawait[39m response[33m.[39m[34mjson[39m()[33m;[39m
    [90m172| [39m
    [90m173| [39m    [34mexpect[39m(response[33m.[39mstatus)[33m.[39m[34mtoBe[39m([34m200[39m)[33m;[39m
    [90m   | [39m                            [31m^[39m
    [90m174| [39m    [35mif[39m (json[33m.[39mepics [33m&&[39m json[33m.[39mepics[33m.[39mlength [33m>[39m [34m0[39m) {
    [90m175| [39m      [34mexpect[39m(json[33m.[39mepics[[34m0[39m])[33m.[39m[34mtoHaveProperty[39m([32m'story_count'[39m)[33m;[39m

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[3/24]â¯[22m[39m

[41m[1m FAIL [22m[49m src/__tests__/US-8.2/api-get.test.ts[2m > [22mGET /api/epics[2m > [22mAC1.5: should return empty array if no epics exist
[31m[1mAssertionError[22m: expected 500 to be 200 // Object.is equality[39m

[32m- Expected[39m
[31m+ Received[39m

[32m- 200[39m
[31m+ 500[39m

[36m [2mâ¯[22m src/__tests__/US-8.2/api-get.test.ts:[2m193:29[22m[39m
    [90m191| [39m    [35mconst[39m json [33m=[39m [35mawait[39m response[33m.[39m[34mjson[39m()[33m;[39m
    [90m192| [39m
    [90m193| [39m    [34mexpect[39m(response[33m.[39mstatus)[33m.[39m[34mtoBe[39m([34m200[39m)[33m;[39m
    [90m   | [39m                            [31m^[39m
    [90m194| [39m    [34mexpect[39m(json[33m.[39mepics)[33m.[39m[34mtoEqual[39m([])[33m;[39m
    [90m195| [39m  })[33m;[39m

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[4/24]â¯[22m[39m

[41m[1m FAIL [22m[49m src/__tests__/US-8.2/api-get.test.ts[2m > [22mGET /api/epics/[id][2m > [22mAC1.7: should return 404 if epic does not exist
[31m[1mAssertionError[22m: expected 500 to be 404 // Object.is equality[39m

[32m- Expected[39m
[31m+ Received[39m

[32m- 404[39m
[31m+ 500[39m

[36m [2mâ¯[22m src/__tests__/US-8.2/api-get.test.ts:[2m235:29[22m[39m
    [90m233| [39m    const response = await GET_EPIC_BY_ID(request, { params: { id: 'noâ€¦
    [90m234| [39m
    [90m235| [39m    [34mexpect[39m(response[33m.[39mstatus)[33m.[39m[34mtoBe[39m([34m404[39m)[33m;[39m
    [90m   | [39m                            [31m^[39m
    [90m236| [39m  })[33m;[39m
    [90m237| [39m

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[5/24]â¯[22m[39m

[41m[1m FAIL [22m[49m src/__tests__/US-8.2/api-get.test.ts[2m > [22mGET /api/epics/[id][2m > [22mAC1.8: should return 404 if epic belongs to different household
[31m[1mAssertionError[22m: expected 500 to be 403 // Object.is equality[39m

[32m- Expected[39m
[31m+ Received[39m

[32m- 403[39m
[31m+ 500[39m

[36m [2mâ¯[22m src/__tests__/US-8.2/api-get.test.ts:[2m258:29[22m[39m
    [90m256| [39m    const response = await GET_EPIC_BY_ID(request, { params: { id: 'epâ€¦
    [90m257| [39m
    [90m258| [39m    [34mexpect[39m(response[33m.[39mstatus)[33m.[39m[34mtoBe[39m([34m403[39m)[33m;[39m
    [90m   | [39m                            [31m^[39m
    [90m259| [39m  })[33m;[39m
    [90m260| [39m

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[6/24]â¯[22m[39m

[41m[1m FAIL [22m[49m src/__tests__/US-8.2/api-get.test.ts[2m > [22mGET /api/epics/[id][2m > [22mAC1.9: should return epic with nested stories array
[31m[1mAssertionError[22m: expected 500 to be 200 // Object.is equality[39m

[32m- Expected[39m
[31m+ Received[39m

[32m- 200[39m
[31m+ 500[39m

[36m [2mâ¯[22m src/__tests__/US-8.2/api-get.test.ts:[2m277:29[22m[39m
    [90m275| [39m    [35mconst[39m json [33m=[39m [35mawait[39m response[33m.[39m[34mjson[39m()[33m;[39m
    [90m276| [39m
    [90m277| [39m    [34mexpect[39m(response[33m.[39mstatus)[33m.[39m[34mtoBe[39m([34m200[39m)[33m;[39m
    [90m   | [39m                            [31m^[39m
    [90m278| [39m    [34mexpect[39m(json[33m.[39mepic)[33m.[39m[34mtoBeDefined[39m()[33m;[39m
    [90m279| [39m    [34mexpect[39m(json[33m.[39mepic[33m.[39mid)[33m.[39m[34mtoBe[39m([32m'epic-1'[39m)[33m;[39m

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[7/24]â¯[22m[39m

[41m[1m FAIL [22m[49m src/__tests__/US-8.2/api-get.test.ts[2m > [22mGET /api/epics/[id][2m > [22mAC1.10: should include all story fields (id, title, completed, etc.)
[31m[1mAssertionError[22m: expected 500 to be 200 // Object.is equality[39m

[32m- Expected[39m
[31m+ Received[39m

[32m- 200[39m
[31m+ 500[39m

[36m [2mâ¯[22m src/__tests__/US-8.2/api-get.test.ts:[2m299:29[22m[39m
    [90m297| [39m    [35mconst[39m json [33m=[39m [35mawait[39m response[33m.[39m[34mjson[39m()[33m;[39m
    [90m298| [39m
    [90m299| [39m    [34mexpect[39m(response[33m.[39mstatus)[33m.[39m[34mtoBe[39m([34m200[39m)[33m;[39m
    [90m   | [39m                            [31m^[39m
    [90m300| [39m    if (json.epic && json.epic.stories && json.epic.stories.length > 0â€¦
    [90m301| [39m      [35mconst[39m story [33m=[39m json[33m.[39mepic[33m.[39mstories[[34m0[39m][33m;[39m

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[8/24]â¯[22m[39m

[41m[1m FAIL [22m[49m src/__tests__/US-8.2/api-get.test.ts[2m > [22mGET /api/epics/[id]/stories[2m > [22mAC1.12: should return 404 if epic does not exist
[31m[1mAssertionError[22m: expected 500 to be 404 // Object.is equality[39m

[32m- Expected[39m
[31m+ Received[39m

[32m- 404[39m
[31m+ 500[39m

[36m [2mâ¯[22m src/__tests__/US-8.2/api-get.test.ts:[2m346:29[22m[39m
    [90m344| [39m    const response = await GET_STORIES(request, { params: { id: 'nonexâ€¦
    [90m345| [39m
    [90m346| [39m    [34mexpect[39m(response[33m.[39mstatus)[33m.[39m[34mtoBe[39m([34m404[39m)[33m;[39m
    [90m   | [39m                            [31m^[39m
    [90m347| [39m  })[33m;[39m
    [90m348| [39m

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[9/24]â¯[22m[39m

[41m[1m FAIL [22m[49m src/__tests__/US-8.2/api-get.test.ts[2m > [22mGET /api/epics/[id]/stories[2m > [22mAC1.13: should return 403 if epic belongs to different household
[31m[1mAssertionError[22m: expected 500 to be 403 // Object.is equality[39m

[32m- Expected[39m
[31m+ Received[39m

[32m- 403[39m
[31m+ 500[39m

[36m [2mâ¯[22m src/__tests__/US-8.2/api-get.test.ts:[2m369:29[22m[39m
    [90m367| [39m    const response = await GET_STORIES(request, { params: { id: 'epic-â€¦
    [90m368| [39m
    [90m369| [39m    [34mexpect[39m(response[33m.[39mstatus)[33m.[39m[34mtoBe[39m([34m403[39m)[33m;[39m
    [90m   | [39m                            [31m^[39m
    [90m370| [39m  })[33m;[39m
    [90m371| [39m

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[10/24]â¯[22m[39m

[41m[1m FAIL [22m[49m src/__tests__/US-8.2/api-get.test.ts[2m > [22mGET /api/epics/[id]/stories[2m > [22mAC1.14: should return only stories for the specified epic
[31m[1mAssertionError[22m: expected 500 to be 200 // Object.is equality[39m

[32m- Expected[39m
[31m+ Received[39m

[32m- 200[39m
[31m+ 500[39m

[36m [2mâ¯[22m src/__tests__/US-8.2/api-get.test.ts:[2m388:29[22m[39m
    [90m386| [39m    [35mconst[39m json [33m=[39m [35mawait[39m response[33m.[39m[34mjson[39m()[33m;[39m
    [90m387| [39m
    [90m388| [39m    [34mexpect[39m(response[33m.[39mstatus)[33m.[39m[34mtoBe[39m([34m200[39m)[33m;[39m
    [90m   | [39m                            [31m^[39m
    [90m389| [39m    [34mexpect[39m([33mArray[39m[33m.[39m[34misArray[39m(json[33m.[39mstories))[33m.[39m[34mtoBe[39m([35mtrue[39m)[33m;[39m
    [90m390| [39m  })[33m;[39m

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[11/24]â¯[22m[39m

[41m[1m FAIL [22m[49m src/__tests__/US-8.2/api-get.test.ts[2m > [22mGET /api/epics/[id]/stories[2m > [22mAC1.15: should return empty array if epic has no stories
[31m[1mAssertionError[22m: expected 500 to be 200 // Object.is equality[39m

[32m- Expected[39m
[31m+ Received[39m

[32m- 200[39m
[31m+ 500[39m

[36m [2mâ¯[22m src/__tests__/US-8.2/api-get.test.ts:[2m408:29[22m[39m
    [90m406| [39m    [35mconst[39m json [33m=[39m [35mawait[39m response[33m.[39m[34mjson[39m()[33m;[39m
    [90m407| [39m
    [90m408| [39m    [34mexpect[39m(response[33m.[39mstatus)[33m.[39m[34mtoBe[39m([34m200[39m)[33m;[39m
    [90m   | [39m                            [31m^[39m
    [90m409| [39m    [34mexpect[39m(json[33m.[39mstories)[33m.[39m[34mtoEqual[39m([])[33m;[39m
    [90m410| [39m  })[33m;[39m

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[12/24]â¯[22m[39m

[41m[1m FAIL [22m[49m src/__tests__/US-8.2/api-mutations.test.ts[2m > [22mPOST /api/epics[2m > [22mAC2.3: should validate that title is required
[31m[1mAssertionError[22m: expected 'Title is required and must be a string' to contain 'title'[39m

Expected: [32m"title"[39m
Received: [31m"Title is required and must be a string"[39m

[36m [2mâ¯[22m src/__tests__/US-8.2/api-mutations.test.ts:[2m166:24[22m[39m
    [90m164| [39m
    [90m165| [39m    [34mexpect[39m(response[33m.[39mstatus)[33m.[39m[34mtoBe[39m([34m400[39m)[33m;[39m
    [90m166| [39m    [34mexpect[39m(json[33m.[39merror)[33m.[39m[34mtoContain[39m([32m'title'[39m)[33m;[39m
    [90m   | [39m                       [31m^[39m
    [90m167| [39m  })[33m;[39m
    [90m168| [39m

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[13/24]â¯[22m[39m

[41m[1m FAIL [22m[49m src/__tests__/US-8.2/api-mutations.test.ts[2m > [22mPOST /api/epics/[id]/stories[2m > [22mAC2.10: should validate that title is required
[31m[1mAssertionError[22m: expected 'Title is required and must be a string' to contain 'title'[39m

Expected: [32m"title"[39m
Received: [31m"Title is required and must be a string"[39m

[36m [2mâ¯[22m src/__tests__/US-8.2/api-mutations.test.ts:[2m323:24[22m[39m
    [90m321| [39m
    [90m322| [39m    [34mexpect[39m(response[33m.[39mstatus)[33m.[39m[34mtoBe[39m([34m400[39m)[33m;[39m
    [90m323| [39m    [34mexpect[39m(json[33m.[39merror)[33m.[39m[34mtoContain[39m([32m'title'[39m)[33m;[39m
    [90m   | [39m                       [31m^[39m
    [90m324| [39m  })[33m;[39m
    [90m325| [39m

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[14/24]â¯[22m[39m

[41m[1m FAIL [22m[49m src/__tests__/US-8.2/api-mutations.test.ts[2m > [22mPUT /api/tasks/[id]/parent[2m > [22mAC2.16: should update parent_id of story
[31m[1mTypeError[22m: Cannot read properties of undefined (reading 'parent_id')[39m
[36m [2mâ¯[22m src/__tests__/US-8.2/api-mutations.test.ts:[2m463:27[22m[39m
    [90m461| [39m    const response = await PUT_PARENT(request, { params: { id: 'story-â€¦
    [90m462| [39m
    [90m463| [39m    [34mexpect[39m(capturedUpdate[33m.[39mparent_id)[33m.[39m[34mtoBe[39m([32m'epic-2'[39m)[33m;[39m
    [90m   | [39m                          [31m^[39m
    [90m464| [39m  })[33m;[39m
    [90m465| [39m

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[15/24]â¯[22m[39m

[41m[1m FAIL [22m[49m src/__tests__/US-8.2/api-mutations.test.ts[2m > [22mPUT /api/tasks/[id]/parent[2m > [22mAC2.17: should return 200 with updated story
[31m[1mAssertionError[22m: expected 400 to be 200 // Object.is equality[39m

[32m- Expected[39m
[31m+ Received[39m

[32m- 200[39m
[31m+ 400[39m

[36m [2mâ¯[22m src/__tests__/US-8.2/api-mutations.test.ts:[2m486:29[22m[39m
    [90m484| [39m    [35mconst[39m json [33m=[39m [35mawait[39m response[33m.[39m[34mjson[39m()[33m;[39m
    [90m485| [39m
    [90m486| [39m    [34mexpect[39m(response[33m.[39mstatus)[33m.[39m[34mtoBe[39m([34m200[39m)[33m;[39m
    [90m   | [39m                            [31m^[39m
    [90m487| [39m    [34mexpect[39m(json[33m.[39mstory[33m.[39mparent_id)[33m.[39m[34mtoBe[39m([32m'epic-2'[39m)[33m;[39m
    [90m488| [39m  })[33m;[39m

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[16/24]â¯[22m[39m

[41m[1m FAIL [22m[49m src/__tests__/US-8.2/api-mutations.test.ts[2m > [22mDELETE /api/epics/[id][2m > [22mAC2.19: should return 404 if epic does not exist
[31m[1mAssertionError[22m: expected 500 to be 404 // Object.is equality[39m

[32m- Expected[39m
[31m+ Received[39m

[32m- 404[39m
[31m+ 500[39m

[36m [2mâ¯[22m src/__tests__/US-8.2/api-mutations.test.ts:[2m528:29[22m[39m
    [90m526| [39m    const response = await DELETE_EPIC(request, { params: { id: 'nonexâ€¦
    [90m527| [39m
    [90m528| [39m    [34mexpect[39m(response[33m.[39mstatus)[33m.[39m[34mtoBe[39m([34m404[39m)[33m;[39m
    [90m   | [39m                            [31m^[39m
    [90m529| [39m  })[33m;[39m
    [90m530| [39m

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[17/24]â¯[22m[39m

[41m[1m FAIL [22m[49m src/__tests__/US-8.2/api-mutations.test.ts[2m > [22mDELETE /api/epics/[id][2m > [22mAC2.20: should return 403 if epic belongs to different household
[31m[1mAssertionError[22m: expected 500 to be 403 // Object.is equality[39m

[32m- Expected[39m
[31m+ Received[39m

[32m- 403[39m
[31m+ 500[39m

[36m [2mâ¯[22m src/__tests__/US-8.2/api-mutations.test.ts:[2m551:29[22m[39m
    [90m549| [39m    const response = await DELETE_EPIC(request, { params: { id: 'epic-â€¦
    [90m550| [39m
    [90m551| [39m    [34mexpect[39m(response[33m.[39mstatus)[33m.[39m[34mtoBe[39m([34m403[39m)[33m;[39m
    [90m   | [39m                            [31m^[39m
    [90m552| [39m  })[33m;[39m
    [90m553| [39m

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[18/24]â¯[22m[39m

[41m[1m FAIL [22m[49m src/__tests__/US-8.2/api-mutations.test.ts[2m > [22mDELETE /api/epics/[id][2m > [22mAC2.21: should delete epic and cascade delete all its stories
[31m[1mAssertionError[22m: expected 0 to be greater than 0[39m
[36m [2mâ¯[22m src/__tests__/US-8.2/api-mutations.test.ts:[2m577:33[22m[39m
    [90m575| [39m
    [90m576| [39m    [90m// Should delete epic and its stories[39m
    [90m577| [39m    [34mexpect[39m(deletedTasks[33m.[39mlength)[33m.[39m[34mtoBeGreaterThan[39m([34m0[39m)[33m;[39m
    [90m   | [39m                                [31m^[39m
    [90m578| [39m  })[33m;[39m
    [90m579| [39m

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[19/24]â¯[22m[39m

[41m[1m FAIL [22m[49m src/__tests__/US-8.2/api-mutations.test.ts[2m > [22mDELETE /api/epics/[id][2m > [22mAC2.22: should return 200 on successful deletion
[31m[1mAssertionError[22m: expected 500 to be 200 // Object.is equality[39m

[32m- Expected[39m
[31m+ Received[39m

[32m- 200[39m
[31m+ 500[39m

[36m [2mâ¯[22m src/__tests__/US-8.2/api-mutations.test.ts:[2m599:29[22m[39m
    [90m597| [39m    [35mconst[39m json [33m=[39m [35mawait[39m response[33m.[39m[34mjson[39m()[33m;[39m
    [90m598| [39m
    [90m599| [39m    [34mexpect[39m(response[33m.[39mstatus)[33m.[39m[34mtoBe[39m([34m200[39m)[33m;[39m
    [90m   | [39m                            [31m^[39m
    [90m600| [39m    [34mexpect[39m(json[33m.[39msuccess)[33m.[39m[34mtoBe[39m([35mtrue[39m)[33m;[39m
    [90m601| [39m  })[33m;[39m

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[20/24]â¯[22m[39m

[41m[1m FAIL [22m[49m src/__tests__/US-8.2/validation.test.ts[2m > [22mAC4: Story Validation[2m > [22mAC4.5: should reject story creation without parent_id with 400 error
[31m[1mAssertionError[22m: expected 500 to be 400 // Object.is equality[39m

[32m- Expected[39m
[31m+ Received[39m

[32m- 400[39m
[31m+ 500[39m

[36m [2mâ¯[22m src/__tests__/US-8.2/validation.test.ts:[2m240:29[22m[39m
    [90m238| [39m    [35mconst[39m json [33m=[39m [35mawait[39m response[33m.[39m[34mjson[39m()[33m;[39m
    [90m239| [39m
    [90m240| [39m    [34mexpect[39m(response[33m.[39mstatus)[33m.[39m[34mtoBe[39m([34m400[39m)[33m;[39m
    [90m   | [39m                            [31m^[39m
    [90m241| [39m    [34mexpect[39m(json[33m.[39merror)[33m.[39m[34mtoBeDefined[39m()[33m;[39m
    [90m242| [39m  })[33m;[39m

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[21/24]â¯[22m[39m

[41m[1m FAIL [22m[49m src/__tests__/US-8.2/validation.test.ts[2m > [22mAC4: Story Nesting Prevention[2m > [22mAC4.11: should reject move story to non-existent parent with 404 error
[31m[1mAssertionError[22m: expected 400 to be 404 // Object.is equality[39m

[32m- Expected[39m
[31m+ Received[39m

[32m- 404[39m
[31m+ 400[39m

[36m [2mâ¯[22m src/__tests__/US-8.2/validation.test.ts:[2m396:29[22m[39m
    [90m394| [39m    [35mconst[39m response [33m=[39m [35mawait[39m [33mPUT[39m(request[33m,[39m { params[33m:[39m { id[33m:[39m [32m'story-1'[39m } })[33m;[39m
    [90m395| [39m
    [90m396| [39m    [34mexpect[39m(response[33m.[39mstatus)[33m.[39m[34mtoBe[39m([34m404[39m)[33m;[39m
    [90m   | [39m                            [31m^[39m
    [90m397| [39m  })[33m;[39m
    [90m398| [39m})[33m;[39m

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[22/24]â¯[22m[39m

[41m[1m FAIL [22m[49m src/__tests__/US-8.2/validation.test.ts[2m > [22mAC5: Error Handling[2m > [22mAC5.2: should return 403 with "Access Denied" for wrong household
[31m[1mAssertionError[22m: expected 500 to be 403 // Object.is equality[39m

[32m- Expected[39m
[31m+ Received[39m

[32m- 403[39m
[31m+ 500[39m

[36m [2mâ¯[22m src/__tests__/US-8.2/validation.test.ts:[2m453:29[22m[39m
    [90m451| [39m    [35mconst[39m json [33m=[39m [35mawait[39m response[33m.[39m[34mjson[39m()[33m;[39m
    [90m452| [39m
    [90m453| [39m    [34mexpect[39m(response[33m.[39mstatus)[33m.[39m[34mtoBe[39m([34m403[39m)[33m;[39m
    [90m   | [39m                            [31m^[39m
    [90m454| [39m    [34mexpect[39m(json[33m.[39merror)[33m.[39m[34mtoBeDefined[39m()[33m;[39m
    [90m455| [39m  })[33m;[39m

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[23/24]â¯[22m[39m

[41m[1m FAIL [22m[49m src/__tests__/US-8.2/validation.test.ts[2m > [22mAC5: Error Handling[2m > [22mAC5.3: should return 404 with "Not Found" for non-existent resource
[31m[1mAssertionError[22m: expected 500 to be 404 // Object.is equality[39m

[32m- Expected[39m
[31m+ Received[39m

[32m- 404[39m
[31m+ 500[39m

[36m [2mâ¯[22m src/__tests__/US-8.2/validation.test.ts:[2m472:29[22m[39m
    [90m470| [39m    const response = await GET(request, { params: { id: 'nonexistent' â€¦
    [90m471| [39m
    [90m472| [39m    [34mexpect[39m(response[33m.[39mstatus)[33m.[39m[34mtoBe[39m([34m404[39m)[33m;[39m
    [90m   | [39m                            [31m^[39m
    [90m473| [39m  })[33m;[39m
    [90m474| [39m

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[24/24]â¯[22m[39m


[2m Test Files [22m [1m[31m4 failed[39m[22m[90m (4)[39m
[2m      Tests [22m [1m[31m23 failed[39m[22m[2m | [22m[1m[32m31 passed[39m[22m[90m (54)[39m
[2m   Start at [22m 00:34:25
[2m   Duration [22m 414ms[2m (transform 163ms, setup 129ms, import 174ms, tests 47ms, environment 828ms)[22m

